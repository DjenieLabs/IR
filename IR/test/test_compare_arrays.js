/*
 * Test the protocol-decoder
 * by Roger Camargo - Dez 2016
 */
var assert = require('assert');

var requirejs = require('requirejs');
requirejs.config({
  paths:{
    "decoder": __dirname + "/../assets/protocol-decoder",
  },
  catchError: true
});

var Decoder = requirejs('decoder');

describe("IR.Decoder", function() {

    /* Test 1
     * Using the same data from the SAMSUNG REMOTE CONTROL - Button Volume +
     */
    it('Should return the same pattern when compared with the same data', function(done) {

      /* we also can load JS here
      requirejs(['decoder'], function(decoder) {
        ...
      });
      */

      // Data 1 from Volume +
      // BB01010100000000000101010000000000010101000000000000000001010101010 35 10000 3 01010100000000000101010000
      var volumeUp_data1 = ["4329", "4329", "333", "1665", "333", "1665", "333", "1665", "333", "666",
                            "333",  "333",  "333", "333",  "333", "333",  "333", "333",  "333", "1665",
                            "333",  "1665", "333", "1665", "333", "333",  "333", "333",  "333", "333",
                            "333",  "333",  "333", "333",  "333", "1665", "333", "1665", "333", "1665",
                            "333",  "333",  "333", "333",  "333", "333",  "333", "333",  "333", "333",
                            "333",  "333",  "333", "333",  "333", "333",  "333", "1665", "333", "1665",
                            "333",  "1665", "333", "1665", "333", "1665", "333", "46620","1332","666",
                            "666",  "333",  "333", "4329", "333", "1665", "333", "1665", "333", "1665",
                            "333",  "333",  "333", "666",  "333", "333",  "333", "333",  "333", "333",
                            "333",  "1665", "333", "1665", "333", "1665", "333", "333",  "333", "333"];

      assert.equal(true, Decoder.compareRawArrays(volumeUp_data1, volumeUp_data1));

      done();
      
    });

    /* Test 2
     * Using the data from the SAMSUNG REMOTE CONTROL - Button Volume +
     */
    
    // NOTE: I'm not sure the source of the raw data, this is the only array that fails!
    // TODO: Find another remote control 

    // it('Vol +: Should return true when 2 arrays of the same button are compared', function(done) {

    //   // Data 1 from Volume +
    //   // BB01010100000000000101010000000000010101000000000000000001010101010 35 10000 3 01010100000000000101010000
    //   var volumeUp_data1 = ["4329", "4329", "333", "1665", "333", "1665", "333", "1665", "333", "666",
    //                         "333",  "333",  "333", "333",  "333", "333",  "333", "333",  "333", "1665",
    //                         "333",  "1665", "333", "1665", "333", "333",  "333", "333",  "333", "333",
    //                         "333",  "333",  "333", "333",  "333", "1665", "333", "1665", "333", "1665",
    //                         "333",  "333",  "333", "333",  "333", "333",  "333", "333",  "333", "333",
    //                         "333",  "333",  "333", "333",  "333", "333",  "333", "1665", "333", "1665",
    //                         "333",  "1665", "333", "1665", "333", "1665", "333", "46620","1332","666",
    //                         "666",  "333",  "333", "4329", "333", "1665", "333", "1665", "333", "1665",
    //                         "333",  "333",  "333", "666",  "333", "333",  "333", "333",  "333", "333",
    //                         "333",  "1665", "333", "1665", "333", "1665", "333", "333",  "333", "333"];

    //   // Data 2 from the same Volume +
    //   // BB 01010100000000000101010000000000010101000000000000000001010101010 35 3 2010101000000000001010100000000
    //   var volumeUp_data2 = ["4464", "3968", "496", "1488", "496", "1488", "496", "1488", "496", "496",
    //                         "496",  "496",  "496", "496",  "496", "496",  "496", "496",  "496", "1488",
    //                         "496",  "1488", "496", "1488", "496", "496",  "496", "496",  "496", "496",
    //                         "496",  "496",  "496", "496",  "496", "1488", "496", "1488", "496", "1488",
    //                         "496",  "496",  "496", "496",  "496", "496",  "496", "496",  "496", "496",
    //                         "496",  "496",  "496", "496",  "496", "496",  "496", "1488", "496", "1488",
    //                         "496",  "1488", "496", "1488", "496", "1488", "496", "46624","4464","3968",
    //                         "496",  "1488", "496", "1488", "496", "1488", "496", "496",  "496", "496",
    //                         "496",  "496",  "496", "496",  "496", "496",  "496", "1488", "496", "1488",
    //                         "496",  "1488", "496", "496",  "496", "496",  "496", "496",  "496", "496"];


    //   assert.equal(true, Decoder.compareRawArrays(volumeUp_data1, volumeUp_data2));

    //   done();
      
    // });

    /**
     * Test 3
     * Channel Up
     */
    it('CH+, Should return the same pattern when compared', function(done) {
      // Length: 135
      var channelUp_data1 = ["4080", "4080", "510", "1530", "510", "1530", "510", "1530", "510", "510", 
                            "510", "510", "510", "510", "510", "510", "510", "510", "510", "1530", 
                            "510", "1530", "510", "1530", "510", "510", "510", "510", "510", "510", 
                            "510", "510", "510", "510", "510", "510", "510", "1530", "510", "510", 
                            "510", "510", "510", "1530", "510", "510", "510", "510", "510", "510", 
                            "510", "1530", "510", "510", "510", "1530", "510", "1530", "510", "510", 
                            "510", "1530", "510", "1530", "510", "1530", "510", "46410", "4080", "4080", 
                            "510", "1530", "510", "1530", "510", "1530", "510", "510", "510", "510", 
                            "510", "510", "510", "510", "510", "510", "510", "1530", "510", "1530", 
                            "510", "1530", "510", "510", "510", "510", "510", "510", "510", "510",
                            "510", "510", "510", "510", "510", "1530", "510", "510", "510", "510", 
                            "510", "1530", "510", "510", "510", "510", "510", "510", "510", "1530", 
                            "510", "510", "510", "1530", "510", "1530", "510", "510", "510", "1530", 
                            "510", "1530", "510", "1530", "510"];
      // Length: 135
      var channelUp_data2 = ["4008", "4008", "501", "1503", "501", "1503", "501", "1503", "501", "501", 
                            "501", "501", "501", "501", "501", "501", "501", "501", "501", "1503", 
                            "501", "1503", "501", "1503", "501", "501", "501", "501", "501", "501", 
                            "501", "501", "501", "501", "501", "501", "501", "1503", "501", "501", 
                            "501", "501", "501", "1503", "501", "501", "501", "501", "501", "501", 
                            "501", "1503", "501", "501", "501", "1503", "501", "1503", "501", "501", 
                            "501", "1503", "501", "1503", "501", "1503", "501", "46593", "4008", "4008", 
                            "501", "1503", "501", "1503", "501", "1503", "501", "501", "501", "501", 
                            "501", "501", "501", "501", "501", "501", "501", "1503", "501", "1503", 
                            "501", "1503", "501", "501", "501", "501", "501", "501", "501", "501",
                            "501", "501", "501", "501", "501", "1503", "501", "501", "501", "501", 
                            "501", "1503", "501", "501", "501", "501", "501", "501", "501", "1503", 
                            "501", "501", "501", "1503", "501", "1503", "501", "501", "501", "1503", 
                            "501", "1503", "501", "1503", "501"];

       var channelUp_data3 = ["4473", "3976", "497", "1491", "497", "1491", "497", "1491", "497", "497", 
                              "497", "497", "497", "497", "497", "497", "497", "497", "497", "1491", 
                              "497", "1491", "497", "1491", "497", "497", "497", "497", "497", "497", 
                              "497", "497", "497", "497", "497", "497", "497", "1491", "497", "497", 
                              "497", "497", "497", "1491", "497", "497", "497", "497", "497", "497", 
                              "497", "1491", "497", "497", "497", "1491", "497", "1491", "497", "497", 
                              "497", "1491", "497", "1491", "497", "1491", "497", "46221", "4473", "3976", 
                              "497", "1491", "497", "1491", "497", "1491", "497", "497", "497", "497", 
                              "497", "497", "497", "497", "497", "497", "497", "1491", "497", "1491", 
                              "497", "1491", "497", "497", "497", "497", "497", "497", "497", "497",
                              "497", "497", "497", "497", "497", "1491", "497", "497", "497", "497", 
                              "497", "1491", "497", "497", "497", "497", "497", "497", "497", "1491", 
                              "497", "497", "497", "1491", "497", "1491", "497", "497", "497", "1491", 
                              "497", "1491", "497", "1491", "497"];

      assert.equal(true, Decoder.compareRawArrays(channelUp_data1, channelUp_data2));
      assert.equal(true, Decoder.compareRawArrays(channelUp_data1, channelUp_data3));
      done();
    });

    /**
     * Test 4
     * Number 1
     */
    it('Number 1, Should return the same pattern when compared', function(done) {
      // Length 135
      var NumOne_data1 = ["4248", "4248", "531", "1593", "531", "1593", "531", "1593", "531", "531", 
                          "531", "531", "531", "531", "531", "531", "531", "531", "531", "1593", 
                          "531", "1593", "531", "1593", "531", "531", "531", "531", "531", "531", 
                          "531", "531", "531", "531", "531", "531", "531", "531", "531", "1593", 
                          "531", "531", "531", "531", "531", "531", "531", "531", "531", "531", 
                          "531", "1593", "531", "1593", "531", "531", "531", "1593", "531", "1593", 
                          "531", "1593", "531", "1593", "531", "1593", "531", "46728", "4248", "4248", 
                          "531", "1593", "531", "1593", "531", "1593", "531", "531", "531", "531", 
                          "531", "531", "531", "531", "531", "531", "531", "1593", "531", "1593", 
                          "531", "1593", "531", "531", "531", "531", "531", "531", "531", "531",
                          "531", "531", "531", "531", "531", "531", "531", "1593", "531", "531", 
                          "531", "531", "531", "531", "531", "531", "531", "531", "531", "1593", 
                          "531", "1593", "531", "531", "531", "1593", "531", "1593", "531", "1593", 
                          "531", "1593", "531", "1593", "531"];

      // Length 135
      var NumOne_data2 = ["4184", "4184", "523", "1569", "523", "1569", "523", "1569", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "523", "523", "1569", 
                          "523", "1569", "523", "1569", "523", "523", "523", "523", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "523", "523", "1569", 
                          "523", "523", "523", "523", "523", "523", "523", "523", "523", "523", 
                          "523", "1569", "523", "1569", "523", "523", "523", "1569", "523", "1569", 
                          "523", "1569", "523", "1569", "523", "1569", "523", "46547", "4184", "4184", 
                          "523", "1569", "523", "1569", "523", "1569", "523", "523", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "1569", "523", "1569", 
                          "523", "1569", "523", "523", "523", "523", "523", "523", "523", "523",
                          "523", "523", "523", "523", "523", "523", "523", "1569", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "523", "523", "1569", 
                          "523", "1569", "523", "523", "523", "1569", "523", "1569", "523", "1569", 
                          "523", "1569", "523", "1569", "523"];

      // Length 135
      var NumOne_data3 = ["4509", "4008", "501", "1503", "501", "1503", "501", "1503", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "501", "501", "1503", 
                          "501", "1503", "501", "1503", "501", "501", "501", "501", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "501", "501", "1503", 
                          "501", "501", "501", "501", "501", "501", "501", "501", "501", "501", 
                          "501", "1503", "501", "1503", "501", "501", "501", "1503", "501", "1503", 
                          "501", "1503", "501", "1503", "501", "1503", "501", "46593", "4008", "4008", 
                          "501", "1503", "501", "1503", "501", "1503", "501", "501", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "1503", "501", "1503", 
                          "501", "1503", "501", "501", "501", "501", "501", "501", "501", "501",
                          "501", "501", "501", "501", "501", "501", "501", "1503", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "501", "501", "1503", 
                          "501", "1503", "501", "501", "501", "1503", "501", "1503", "501", "1503", 
                          "501", "1503", "501", "1503", "501"];

      assert.equal(true, Decoder.compareRawArrays(NumOne_data1, NumOne_data2));
      assert.equal(true, Decoder.compareRawArrays(NumOne_data1, NumOne_data3));
      done();
    });

    /**
     * Test 5
     * Power Button
     */
    it("Power Button. It should return the same pattern when compared", function(done){
      powerButton_data1 = ["4184", "4184", "523", "1569", "523", "1569", "523", "1569", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "523", "523", "1569", 
                          "523", "1569", "523", "1569", "523", "523", "523", "523", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "1569", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "523", "523", "523", 
                          "523", "1569", "523", "523", "523", "1569", "523", "1569", "523", "1569", 
                          "523", "1569", "523", "1569", "523", "1569", "523", "46547", "4184", "4184", 
                          "523", "1569", "523", "1569", "523", "1569", "523", "523", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "1569", "523", "1569", 
                          "523", "1569", "523", "523", "523", "523", "523", "523", "523", "523",
                          "523", "523", "523", "523", "523", "1569", "523", "523", "523", "523", 
                          "523", "523", "523", "523", "523", "523", "523", "523", "523", "1569", 
                          "523", "523", "523", "1569", "523", "1569", "523", "1569", "523", "1569", 
                          "523", "1569", "523", "1569", "523"];

      powerButton_data2 = ["4008", "4008", "501", "1503", "501", "1503", "501", "1503", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "501", "501", "1503", 
                          "501", "1503", "501", "1503", "501", "501", "501", "501", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "1503", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "501", "501", "501", 
                          "501", "1503", "501", "501", "501", "1503", "501", "1503", "501", "1503", 
                          "501", "1503", "501", "1503", "501", "1503", "501", "46593", "4008", "4008", 
                          "501", "1503", "501", "1503", "501", "1503", "501", "501", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "1503", "501", "1503", 
                          "501", "1503", "501", "501", "501", "501", "501", "501", "501", "501",
                          "501", "501", "501", "501", "501", "1503", "501", "501", "501", "501", 
                          "501", "501", "501", "501", "501", "501", "501", "501", "501", "1503", 
                          "501", "501", "501", "1503", "501", "1503", "501", "1503", "501", "1503", 
                          "501", "1503", "501", "1503", "501"];

      powerButton_data3 = ["4473", "3976", "497", "1491", "497", "1491", "497", "1491", "497", "497", 
                          "497", "497", "497", "497", "497", "497", "497", "497", "497", "1491", 
                          "497", "1491", "497", "1491", "497", "497", "497", "497", "497", "497", 
                          "497", "497", "497", "497", "497", "497", "497", "1491", "497", "497", 
                          "497", "497", "497", "497", "497", "497", "497", "497", "497", "497", 
                          "497", "1491", "497", "497", "497", "1491", "497", "1491", "497", "1491",
                          "497", "1491", "497", "1491", "497", "1491", "497", "46718", "3976", "4473", 
                          "497", "1491", "497", "1491", "497", "1491", "497", "497", "497", "497", 
                          "497", "497", "497", "497", "497", "497", "497", "1491", "497", "1491", 
                          "497", "1491", "497", "497", "497", "497", "497", "497", "497", "497",
                          "497", "497", "497", "497", "497", "1491", "497", "497", "497", "497", 
                          "497", "497", "497", "497", "497", "497", "497", "497", "497", "1491", 
                          "497", "497", "497", "1491", "497", "1491", "497", "1491", "497", "1491", 
                          "497", "1491", "497", "1491", "497"];

      assert.equal(true, Decoder.compareRawArrays(powerButton_data1, powerButton_data2));
      assert.equal(true, Decoder.compareRawArrays(powerButton_data1, powerButton_data3));
      done();
    });
});
