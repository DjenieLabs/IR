"use strict";define(["helpers"],function(t){function e(t,e){return"NEC"===t.type&&"NEC"===e.type&&t.command===e.command}function s(e){if(!t.inRange(e[0],9e3)){var i=this,r=!1;return e.some(function(n,a){if(t.inRange(e[a],9e3))return r=s.call(i,e.slice(a)),!0}),r}if(t.inRange(e[1],4500)){var a=n(this.protocol.logic1,this.protocol.logic0,this.protocol.end,this.protocol.totalMessage-this.protocol.totalData,this.protocol.repeat,e.slice(2));return a&&(a.address=parseInt(a.string.substr(0,8),2),a.command=parseInt(a.string.substr(16,8),2),a.type="NEC",this._lastCode=a,this._lastAt=t.millis()),a}return!1}function n(e,s,n,i,r,a){for(var o="",l=0;l<a.length;l+=2)t.inRange(a[l],e.burst)&&t.inRange(a[l+1],e.space)?o+="1":t.inRange(a[l],s.burst)&&t.inRange(a[l+1],s.space)?o+="0":t.inRange(a[l],n)&&t.inRange(a[l+1],i)?o+="_":t.inRange(a[l],r.burst)&&t.inRange(a[l+1],r.space)&&(o+="R");var c={string:o.split("_")[0],repeat:o.split("R").length};if(c.string.length)c.code=parseInt(c.string,2);else{if(!c.repeat)return console.log("Corrupted NEC data"),!1;this._lastAt&&t.millis()-this._lastAt<108&&(c=this._lastCode,this._lastAt=t.millis())}return c}return new function(){return this.protocol={logic1:{burst:562.5,space:1687},logic0:{burst:562.5,space:562.5},end:562.5,totalMessage:108e3,totalData:67500,repeat:{burst:9e3,space:2250,end:562.5},timeout:108},this.decode=s,this.compare=e,this}});